# üí¨ Instagram-Style Social Media Platform ‚Äî Interview-Friendly High-Level Design (HLD)

---

## üìå Functional Requirements

- User registration & authentication
- User profiles, followers/following
- Home feed: chronological & ranked
- Photo/video posts with captions, tags, location
- Stories (24h ephemeral)
- Short-form videos (Reels/Shorts)
- Direct messaging (1:1, groups)
- Live streaming + real-time comments
- Explore/discovery
- Search (users, tags, places)
- Notifications (likes, comments, follows)
- Likes, comments, saves, shares
- Creator analytics
- Ads, shopping, product tagging
- Moderation, copyright protection
- Offline viewing support

---

## ‚öôÔ∏è Non-Functional Requirements

- High availability, global scale
- Low latency for feed/media
- Scalable recommendations
- Strong privacy & compliance
- Fault tolerance & graceful degradation
- Efficient mobile network/battery usage

---

## üß† System Components

### 1. Client Layer

- Mobile apps & web
- Local caching
- On-device media editing
- Offline actions queue

### 2. API Gateway

- Authentication
- Rate limiting & quota
- Feature flags
- Region-aware routing

### 3. Core Microservices

| Service         | Responsibility                   |
| --------------- | -------------------------------- |
| Registration    | Account creation, verification   |
| User            | Profiles, settings, social graph |
| Feed            | Feed generation & ranking        |
| Media           | Upload, transcoding, storage     |
| Stories         | Ephemeral media handling         |
| Reels           | Short-video pipeline             |
| Notifications   | Push/email/in-app alerts         |
| Messaging       | DMs, attachments                 |
| Search/Explore  | Indexing + retrieval             |
| Recommendations | ML ranking pipeline              |
| Ads             | Targeting & auctions             |
| Live            | Ingest + distribution            |
| Moderation      | Safety + review workflow         |
| Analytics       | Metrics aggregation              |
| ContentID       | Copyright detection              |
| Payments        | Purchases & payouts              |

---

## üìä Estimated Data Metrics

### Users

- MAU: ~1.5B
- DAU: ~500M
- Peak concurrent: ~30M

### Content

- Posts/day: ~200M
- Stories/day: ~500M
- Reels/day: ~50‚Äì200M
- Media size: ~2‚Äì20 MB
- Media ingest: ~400TB‚Äì3PB/day

### Consumption

- Watch/view time: ~30‚Äì60 min/day
- Peak streams: ~200K‚Äì1M/sec
- CDN egress: multiple PB/day

### Social Actions

- ~100 actions/user/day
- Event rate: ~200K‚Äì1M events/sec

---

## üóÉÔ∏è Data Storage Strategy

| Component     | Storage          | Example             |
| ------------- | ---------------- | ------------------- |
| Users & graph | Relational/Graph | Postgres + Neo4j    |
| Media files   | Object storage   | S3/GCS              |
| Feeds         | NoSQL/Key-Value  | Cassandra/DynamoDB  |
| Search        | Search engine    | Elasticsearch/Vespa |
| Stories       | Fast store       | Redis TTL + S3      |
| Messaging     | Wide-column      | Cassandra/Scylla    |
| Realtime chat | In-memory        | Redis Streams       |
| Analytics     | Event lake       | Kafka ‚Üí ClickHouse  |

**Graph & Feed**

- Sharded follow graph
- Hybrid fanout (write for heavy users, read for light users)

---

## üöÄ Data Flow: Create Post ‚Üí Feed Display

1. Client uploads media to API Gateway
2. Media Service stores chunks + hashes
3. Transcoding produces renditions/thumbnails
4. Object Storage saves outputs
5. Feed Service retrieves follower list
6. Recommendation Service scores content
7. Feed DB stores feed entries
8. Notification Service sends alerts
9. Client fetches ranked feed

---

## üõ∞Ô∏è Media Delivery

- CDN + edge caching
- Multiple renditions for ABR playback
- Viewport-aware prefetching
- Client-side compression hints
- Background uploads

---

## üîê Moderation & Safety

- ML classifiers (vision/audio/text)
- Human review for escalations
- Fingerprinting for copyrighted media
- Policy enforcement (age/geo/blocking)
- Bot protection (rate limits, CAPTCHAs)

---

## üß† Recommendations & Search

**Recommendation Flow**

- Events ‚Üí feature store ‚Üí candidate generation (ANN) ‚Üí ranking ‚Üí diversification

**Search/Explore**

- Indexed captions/tags/OCR
- Semantic + lexical ranking
- Personalized reorder

**Creator Growth**

- Boosting for new creators
- A/B testing & controlled rollout

---

## üß© Reels / Short-Video Pipeline

- Fast ingest and GPU-accelerated transcode
- Sound library + rights management
- Metadata-based stitching/remixes
- Aggressive caching of trending videos

---

## üõ†Ô∏è Caching Strategy

| Cached Item        | Store          | TTL             |
| ------------------ | -------------- | --------------- |
| Profile thumbnails | CDN            | Long            |
| Feed segments      | Redis          | Seconds‚Äìminutes |
| Story metadata     | Redis          | 24h             |
| Explore tiles      | Cached service | Minutes         |
| Session tokens     | Redis          | ~30 min         |

---

## üìà Monitoring & Observability

| Metric               | Tooling              |
| -------------------- | -------------------- |
| Feed latency/errors  | Prometheus + Grafana |
| Playback performance | RUM                  |
| ML drift             | MLflow               |
| Moderation accuracy  | Datadog/ELK          |
| Ads delivery         | OpenTelemetry        |

SLOs:

- Feed load <300ms (cached)
- Rebuffer rate <1‚Äì3%
- Moderation SLA: minutes‚Äìhours

---

## üîÑ Scalability & Availability

- Hybrid feed generation
- Event-driven architecture (Kafka)
- Sharded social graph
- Autoscaling GPU transcode + ML
- Multi-region active-active deployment

---

## üîê Privacy, Monetization & Ads

- Ads: client + server-side auctions
- Shopping: product metadata + checkout flows
- Creator payouts & subscriptions
- Privacy controls (private account, block, data export)
- Minimal PII in analytics

---

## üß± Example Tech Stack

| Layer       | Technologies               |
| ----------- | -------------------------- |
| Frontend    | Kotlin/Swift/React         |
| API         | Go/Java/Python, gRPC/HTTP2 |
| Media       | FFmpeg + GPU nodes         |
| Storage/CDN | S3/GCS + major CDNs        |
| Streams     | Kafka/PubSub               |
| Databases   | Cassandra/Spanner/Postgres |
| Search      | Elasticsearch/Vespa        |
| Cache       | Redis/Memcached            |
| Analytics   | ClickHouse/BigQuery        |
| ML          | PyTorch/TensorFlow, KServe |

---

## üîÑ Design Trade-offs & Challenges

| Challenge                 | Approach                    |
| ------------------------- | --------------------------- |
| Freshness vs compute cost | Hybrid feed strategy        |
| Storage cost              | Tiered storage & archiving  |
| Moderation scale          | ML + human review           |
| Spam control              | Trust signals + limits      |
| Ads personalization       | Edge + server decisioning   |
| Viral load                | Rapid fanout with throttles |

---

## üìä Final Notes

- Emphasize feed generation strategy
- Highlight media lifecycle and CDN flow
- Stress ML pipelines for ranking & moderation
- Use clear assumptions and SLOs in interviews

---
